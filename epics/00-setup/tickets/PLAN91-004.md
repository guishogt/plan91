# PLAN91-004 - Create Maven Project Structure

**Epic**: 00-Setup
**Priority**: High
**Estimated Effort**: Medium (2-3h)
**Dependencies**: PLAN91-003 (Git repository)
**Status**: ✅ Completed

## Context

Initialize the Spring Boot Maven project with all necessary dependencies for Plan 91. This creates the foundation for the backend application.

The project uses Spring Boot 3.2.x (compatible with Java 21) and follows Maven standard directory layout.

## Domain Knowledge Required

- Spring Boot project structure
- Maven dependency management
- Java 21 features

## Acceptance Criteria

- [ ] pom.xml created with all required dependencies
- [ ] Spring Boot 3.2.x configured
- [ ] Java 21 source/target version set
- [ ] All core dependencies included (Spring Web, JPA, Security, etc.)
- [ ] Maven directory structure created
- [ ] Application main class created
- [ ] application.yml created with basic config
- [ ] Project compiles successfully with `mvn clean compile`
- [ ] No dependency conflicts

## Technical Requirements

### Implementation Details

Create Maven project with Spring Boot 3.2.x and Java 21.

### Dependencies Required

**Core Spring Boot**:
- spring-boot-starter-web (REST APIs, Thymeleaf)
- spring-boot-starter-data-jpa (Database access)
- spring-boot-starter-security (Security + Auth0)
- spring-boot-starter-thymeleaf (Server-side templates)
- spring-boot-starter-validation (Bean validation)

**Database**:
- mysql-connector-j (MySQL driver)
- flyway-core (Database migrations)
- flyway-mysql (MySQL-specific Flyway)

**Mapping & Utilities**:
- mapstruct (DTO mapping)
- lombok (Reduce boilerplate)

**Testing**:
- spring-boot-starter-test (Testing framework)
- testcontainers (Integration tests with Docker)

**Optional** (will add later):
- Auth0 Spring Security
- HTMX webjars

### Project Structure

```
plan91/
├── pom.xml
├── src/
│   ├── main/
│   │   ├── java/com/ctoblue/plan91/
│   │   │   └── Plan91Application.java
│   │   └── resources/
│   │       ├── application.yml
│   │       ├── application-dev.yml
│   │       ├── application-test.yml
│   │       ├── static/
│   │       │   ├── css/
│   │       │   ├── js/
│   │       │   └── images/
│   │       ├── templates/
│   │       └── db/migration/
│   │           └── .gitkeep
│   └── test/
│       ├── java/com/ctoblue/plan91/
│       │   └── Plan91ApplicationTests.java
│       └── resources/
│           └── application-test.yml
└── target/ (generated, gitignored)
```

### pom.xml Template

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
         https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.2</version>
    </parent>

    <groupId>com.ctoblue</groupId>
    <artifactId>plan91</artifactId>
    <version>0.1.0-SNAPSHOT</version>
    <name>Plan 91</name>
    <description>Habit tracking with 91-day cycles and one-strike rule</description>

    <properties>
        <java.version>21</java.version>
        <mapstruct.version>1.5.5.Final</mapstruct.version>
        <testcontainers.version>1.19.3</testcontainers.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Starters -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- More dependencies... -->
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
</project>
```

### Application Main Class

```java
package com.ctoblue.plan91;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class Plan91Application {
    public static void main(String[] args) {
        SpringApplication.run(Plan91Application.class, args);
    }
}
```

### application.yml

```yaml
spring:
  application:
    name: plan91

  profiles:
    active: dev

server:
  port: 8080
```

## Definition of Done

- [ ] pom.xml created with all dependencies
- [ ] Maven builds successfully: `mvn clean compile`
- [ ] Application class created
- [ ] Configuration files created
- [ ] Directory structure matches hexagonal architecture (basic)
- [ ] No compiler errors or warnings
- [ ] Dependencies download successfully
- [ ] Spring Boot application starts (smoke test)

## Testing

```bash
# Verify Maven setup
mvn --version

# Clean and compile
mvn clean compile

# Run tests (should pass with basic setup)
mvn test

# Run application (should start Spring Boot)
mvn spring-boot:run

# Should see: "Started Plan91Application in X seconds"
```

## References

- Spring Boot 3.2 Documentation: https://docs.spring.io/spring-boot/docs/3.2.x/reference/html/
- Maven Standard Directory Layout: https://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html
- MapStruct: https://mapstruct.org/

## Notes for Agent

- Use Spring Boot 3.2.x (compatible with Java 21)
- Don't include Auth0 dependencies yet (will add in Epic 03)
- Keep pom.xml clean and well-organized
- Use properties for version management
- Include comments in pom.xml for clarity
- Make sure Lombok annotation processor is configured for MapStruct compatibility

---

## Completion Notes

**Completed**: 2026-01-29
**Agent**: Claude Sonnet 4.5

### What Was Delivered

1. **pom.xml** - Complete Maven configuration with:
   - Spring Boot 3.2.2 (compatible with Java 21)
   - All core dependencies (Web, JPA, Security, Thymeleaf, Validation)
   - MySQL driver and Flyway for database migrations
   - MapStruct for DTO mapping
   - Lombok for boilerplate reduction
   - Testcontainers for integration testing
   - Properly configured annotation processors (Lombok + MapStruct)

2. **Maven Directory Structure**:
   ```
   src/
   ├── main/
   │   ├── java/com/ctoblue/plan91/
   │   │   └── Plan91Application.java
   │   └── resources/
   │       ├── application.yml
   │       ├── application-dev.yml
   │       ├── application-test.yml
   │       ├── static/css/
   │       ├── static/js/
   │       ├── static/images/
   │       ├── templates/
   │       └── db/migration/
   └── test/
       ├── java/com/ctoblue/plan91/
       │   └── Plan91ApplicationTests.java
       └── resources/
           └── application-test.yml
   ```

3. **Plan91Application.java** - Spring Boot main class with:
   - @SpringBootApplication annotation
   - Javadoc documentation
   - Main method for application startup

4. **Configuration Files**:
   - **application.yml**: Base configuration for all profiles
   - **application-dev.yml**: Development profile (MySQL localhost)
   - **application-test.yml**: Test profile (Testcontainers)
   - Proper logging levels configured
   - Flyway enabled for dev and test
   - Security temporarily configured with basic auth (will be replaced with Auth0 in Epic 03)

5. **Test Class** - Basic smoke test to verify Spring context loads

### Build Verification

```bash
$ mvn --version
Apache Maven 3.9.9
Java version: 21.0.9

$ mvn clean compile
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------

$ ls target/classes/
com/ctoblue/plan91/Plan91Application.class ✓
application.yml ✓
application-dev.yml ✓
application-test.yml ✓
```

### Acceptance Criteria Met

- [x] pom.xml created with all required dependencies
- [x] Spring Boot 3.2.x configured
- [x] Java 21 source/target version set
- [x] All core dependencies included (Spring Web, JPA, Security, etc.)
- [x] Maven directory structure created
- [x] Application main class created
- [x] application.yml created with basic config
- [x] Project compiles successfully with `mvn clean compile`
- [x] No dependency conflicts

### Dependencies Included

**Spring Boot Starters**: Web, Data JPA, Security, Thymeleaf, Validation, DevTools
**Database**: MySQL Driver, Flyway Core, Flyway MySQL
**Utilities**: MapStruct, Lombok
**Testing**: Spring Boot Test, Spring Security Test, Testcontainers (core, MySQL, JUnit 5)

### Notes

- Flyway enabled but no migrations yet (will be created in Epic 04)
- Security temporarily uses basic auth (admin/admin) - will be replaced with Auth0 in Epic 03
- DevTools included for hot reload during development
- Annotation processors properly configured for Lombok + MapStruct compatibility

✅ All criteria satisfied

**Status**: Completed
**Created**: 2026-01-29
